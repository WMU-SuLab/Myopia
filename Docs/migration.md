# 迁移文档

- git clone 下载源码，或者获得项目源代码
    - 项目原本位置：/data/Myopia
    - 如果修改了位置，注意修改数据库中本地文件的路径
- 安装环境，具体见[运维文档](ops.md)，注意分为
    - 所需的一些数据或者证书文件
    - Python环境，推荐使用 conda+poetry的方式，一是因为这是目前最好的方式，二是因为其他环境依赖文件可能没有及时更新
    - 软件环境，注意各个软件的配置
        - Supervisor 中关于代码文件夹、环境文件夹、日志文件的路径
        - Nginx 中关于静态文件、证书的路径，转发和域名的配置等等
        - Gunicorn 中各项参数的配置，可以不做更改
    - 初始化项目部分只需要初始化文件夹
- 创建data文件夹的软链接（可选）
    - 主要是为了和NAS的映射绑定，因为服务器本地空间小
    - 还有一种是和OSS本地映射绑定，方便上传，但是需要修改代码中的上传文件逻辑，本项目没有做这种操作，后续如果需要可以自行修改
- 迁移数据库
    - 只需要迁移MySQL
        - 注意修改相关环境变量
        - 注意本地文件是否迁移，未迁移需要修改数据库中的路径
    - 建议在晚上的时候迁移
- 启动项目进行测试
- 联系管理员迁移域名到新服务器上
